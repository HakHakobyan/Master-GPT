---
title: "Expenditure research in Armenia based on Microdata from Armstat (2016)."
author: "Hakob Hakobyan"
date: "2022-10-27"
output: 
  html_document:
    toc: TRUE
    toc_float: TRUE
  
---

## 1. Import of **2016** data and libraries

```{r, echo=TRUE, message=FALSE, warning=FALSE}
library(tidyverse)
library(plotly)
library(scales)
library(foreign)
library(psych)

X2016 <- as_tibble(read.spss("C:/Users/User/OneDrive/Desktop/rmijankyal/Midtermproj/2016.sav", to.data.frame = TRUE))

```

## 2. Visualisation of expenditures

### Frequency of expenditures

```{r echo=TRUE, message=FALSE, warning=FALSE}

histogram <-  ggplot(X2016) + labs(y = "Frequency", x = "Expenditure")+ geom_histogram(aes(x = expend), fill = 'blue',bins = 100)
ggplotly(histogram)


```


### Density curves of expenditures and totincome

```{r echo=TRUE, message=FALSE, warning=FALSE}


density <- ggplot(data = X2016) + 
  labs(title = "Density of Expenditure & Totincome", y = "Density", x = "Expenditure, Totincome") +
    geom_density(aes(x = expend, y = ..density..)) + geom_density(aes(x=totincome, y=..density..), color="red")

ggplotly(density)


```

### Boxpllot of expenditures
```{r echo=TRUE, message=FALSE, warning=FALSE}


boxplot <- ggplot(data = X2016) + labs(title = "Boxplot of expenditures", y = "Expenditure") +
  geom_boxplot(aes(y = expend))

ggplotly(boxplot)

```

The graphs show that the distribution of expenditures is not *normal*, as we have got a positive skewness and a very high value of kurtosis. So most of the outliers are fallen on the *right* side of the graph.

## 3. Descriptive statistics

### Desc.stat for expendirures:
```{r echo=TRUE, message=FALSE, warning=FALSE}
library(pastecs)
options(scipen = 100)
options(digits = 2)
stat.desc(X2016$expend)
library(psych)
describe(X2016$expend)

```

### Desc.stat for totincome:
```{r echo=TRUE, message=FALSE, warning=FALSE}
library(pastecs)
options(scipen = 100)
options(digits = 2)
stat.desc(X2016$totincome)
library(psych)
describe(X2016$totincome)

```
_ As we can see in the results mean of total income is higher than mean of expenditures, which means in 2016 there actually have been savings in Armenia too. In my further research we will see that in many cases households' expenditures are higher than total income though.<br>
_ Although mean of total income is higher than that of expenditures, the range of expenditures are higher than the one of total income. This means that the dispersion of expenditures is higher than the one of totincome.<br>
_ As we can also see in the density graphs, the skewness of expenditure exceeds the one of totincome. Both of them have positive skewness that is heavy tail on the right side.<br>
_ It is clear that from the graph that the kurtosis of totincome is much smaller than that of expenditures, which means the variance of totincome is higher than that of expenditures. In fact our descriptive-statistics data confirms that and we get almost 3 times higher variance for totincome.

## 4. T-test: are the average household expenditures in Armenia euqal to mean of totincome?

**$H_0$: The average household expenditures in Armenia are 195421 AMD.<br>**
**$H_1$: The average household expenditures in Armenia are not equal to 195421 AMD (that is the mean of totincome).**


```{r echo=TRUE, message=FALSE, warning=FALSE}

t.test(x = X2016$expend, mu = mean(X2016$totincome), alternative = "two.sided")
```

As we have got a very low p-value very close to 0, we reject our null hypothesis, which means the average household expenditures are not equal to mean of totincome.


## 5. Independent t-test

**$H_0$: The average household expenditures in different types of settlements in Armenia are equal.<br>**
**$H_1$: The average household expenditures in different types of settlements in Armenia are not equal.**

```{r echo=TRUE, message=FALSE, warning=FALSE}

X2016<-X2016%>%mutate(sett_new=case_when((settlement=="Yerevan"|settlement=="other urban")~"urban", settlement=="rural"~"rural"))
table(X2016$settlement, X2016$sett_new)
t.test(X2016$expend~X2016$sett_new)

```

As we get a p-value lower than 0.01 for our test, we reject the null hypothesis, which means the average household expenditures vary from rural to urban settlements.


## 6. Paired Sample t-test

**$H_0$: The average household expenditures and total income in Armenia are equal.<br>**
**$H_1$: The average household expenditures and total income in Armenia are not equal.**

``` {r echo=TRUE, message=FALSE, warning=FALSE}
t.test(x = X2016$monincome, y =X2016$expend)

```

As long as we got a very low p-value close to 0, we reject the null hypothesis, which means the average household expenditures and total income in Armenia are NOT equal. Economically it means that in Armenia people either would have had savings, or they have just had extra-costs associated with *the interest rates of the loans* taken previously, which is more realistic than the first assumption.

## 7. Expenditure levels


```{r echo=TRUE, message=FALSE, warning=FALSE}

X2016 <- X2016%>%mutate(expendLevels = case_when(expend <= 57000 ~ "Very low", expend <= 89000 ~ "Low", expend <= 300000 ~ "Medium", expend <= 500000 ~ "High", expend > 500000 ~ "Very high") )

X2016$expendLevels<- factor(X2016$expendLevels, ordered = TRUE, levels = c("Very low", "Low", "Medium", "High", "Very high"))

```

## 8. Chi-Square test

**$H_0$: Total expend levels and martial status are independent** <br>
**$H_1$: Total expend levels and martial status are not independent**

```{r echo=TRUE, message=FALSE, warning=FALSE}
chisq.test(X2016$headmerstatus, X2016$expendLevels)

```

As long as we have got a very low p-value almost equal to 0 and smaller than 0.05, it means we can surely reject the null hypothesis. In other words total expend levels and martial status are NOT independent. Economically this means that martial status affects the expenditures either positively or negatively. We may assume that for example those who are married and have children should have much more expenditures related to family expenses.

## 9. ANOVA

**$H_0$**: The means in the groups of the "Martial Status" are equal <br>
**$H_1$**: At least one mean is different.


```{r echo=TRUE, message=FALSE, warning=FALSE}
summary(aov(data = X2016,expend ~ headmerstatus))
```

As the F value of the test is very low almost equal to 0, we reject our null hypothesis, which means at least one mean in the groups of the "Martial Status" *differs* from others. Economically the meanings of this and the previous tests are the same.

## 10. Expenditures in different regions

```{r echo=TRUE, message=FALSE, warning=FALSE}


marzbox <- ggplot() + labs(title = "Expends by Marital status", y = "Expenditures", x = "Marz") +
  geom_boxplot(data = X2016, aes(y = expend, x = marz, color = marz))

ggplotly(marzbox)

```
